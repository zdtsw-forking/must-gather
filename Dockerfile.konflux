FROM registry.redhat.io/openshift4/ose-must-gather-rhel9:v4.20.@sha256:2c7248879f975086b0bfb59bb176c9f381e77caf3dfad40227ebe6404932f3ee
# Install kubectl for xKS environments from Red Hat repos
RUN microdnf install -y --nodocs --setopt=install_weak_deps=0 kubernetes-client && \
    microdnf clean all

# copy original gather from base image to gather_original
RUN mv /usr/bin/gather /usr/bin/gather_original

# copy all collection scripts to /usr/bin, including gather
COPY collection-scripts/* /usr/bin/

ENTRYPOINT ["/usr/bin/gather"]

LABEL com.redhat.component="odh-must-gather" \
      name="odh-must-gather" \
      description="odh-must-gather" \
      summary="odh-must-gather" \
      io.k8s.display-name="odh-must-gather" \
      io.k8s.description="odh-must-gather"
